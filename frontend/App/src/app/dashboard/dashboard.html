<div class="dashboard-container">
  <h2>My Events Dashboard</h2>

  <div class="tabs">
    <button
      [class.active]="selectedTab === 'upcoming'"
      (click)="selectTab('upcoming')"
    >
      Upcoming ({{ events.upcoming.length }})
    </button>
    <button
      [class.active]="selectedTab === 'past'"
      (click)="selectTab('past')"
    >
      Past ({{ events.past.length }})
    </button>
    <button
      [class.active]="selectedTab === 'hosted'"
      (click)="selectTab('hosted')"
    >
      Hosted ({{ events.hosted.length }})
    </button>
  </div>

  <div *ngIf="isLoading" class="loading-state">
    <p>Loading events...</p>
  </div>

  <div class="events-container" *ngIf="!isLoading && getCurrentEvents().length; else noEvents">
    <mat-card *ngFor="let event of getCurrentEvents()" class="event-card">
      <mat-card-header>
        <div mat-card-avatar class="event-avatar">
          <mat-icon>sports_soccer</mat-icon>
        </div>
        <mat-card-title>{{ event.title }}</mat-card-title>
        <mat-card-subtitle>
          {{ formatEventForDisplay(event).category }} â€¢ {{ getSkillLevelName(event.skillLevel || 0) }}
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <div class="event-info">
          <div class="info-row">
            <mat-icon>schedule</mat-icon>
            <span>{{ formatDate(event.startTime) }}</span>
          </div>
          <div class="info-row">
            <mat-icon>location_on</mat-icon>
            <span>{{ event.address || event.location }}</span>
          </div>
          <div class="info-row">
            <mat-icon>people</mat-icon>
            <span>{{ event.freeSlots || 0 }} of {{ event.capacity }} spots available</span>
          </div>
          <div class="info-row" *ngIf="event.statusOfEvent !== undefined">
            <mat-icon>info</mat-icon>
            <span>Status: <strong>{{ getStatusName(event.statusOfEvent) }}</strong></span>
          </div>
        </div>

        <div class="event-tags">
          <mat-chip-set>
            <mat-chip>{{ formatEventForDisplay(event).category }}</mat-chip>
            <mat-chip>{{ getSkillLevelName(event.skillLevel || 0) }}</mat-chip>
            <mat-chip *ngIf="event.freeSlots && event.freeSlots > 0" [class.low-slots]="event.freeSlots <= 2">
              {{ event.freeSlots }} spot{{ event.freeSlots !== 1 ? 's' : '' }} left
            </mat-chip>
            <mat-chip *ngIf="!event.freeSlots || event.freeSlots === 0" class="full">
              Full
            </mat-chip>
          </mat-chip-set>
        </div>
      </mat-card-content>

      <mat-card-actions align="end">
        <button 
          mat-button 
          color="primary" 
          [routerLink]="['/event-details', event.id]"
          (click)="$event.stopPropagation()">
          <mat-icon>info</mat-icon>
          Details
        </button>
        <button 
          *ngIf="event.type === 'hosted'" 
          mat-button 
          color="warn" 
          (click)="$event.stopPropagation(); deleteEvent(event.id, event.title)">
          <mat-icon>delete</mat-icon>
          Cancel
        </button>
      </mat-card-actions>
    </mat-card>
  </div>

  <ng-template #noEvents>
    <div *ngIf="!isLoading" class="empty-message">
      <p>No events found in this category.</p>
      <button mat-raised-button color="primary" (click)="refreshEvents()">Refresh</button>
    </div>
  </ng-template>
</div>
